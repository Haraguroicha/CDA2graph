<element extends="cda2g" name="cdaDemo" constructor="cdaDemo">
	<decorator>
		<template>
			<style scoped="scoped">
				table {
					border: solid 1px black;
					border-collapse: collapse;
					width: 100%;
					display: table;
				}
				table th, table td {
					border: solid 1px black;
				}
				th {
					font-size: 14pt;
				}
				td {
					font-size: 10pt;
				}
				thead {
					display: table-header-group;
				}
				tbody {
					display: table-row-group;
				}
				td, th {
					display: table-cell;
				}
				tr {
					display: table-row;
				}
				h4 {
					margin: 0px;
					border-bottom: solid 1px #06F;
				}
				result {
					margin-top: 0px;
				}
				result ~ * {
					margin-top: 15px;
				}
				h4 ~ * {
					margin-left: 15px;
				}
			</style>
			<processable>
				<green root="通用單張" filename="green.xml"></green>
			</processable>
			<div class="_XCD_Component">
				<table>
					<tr>
						<th colspan="4">
							<selector section="header" path="custodian/assignedCustodian/representedCustodianOrganization/name | recordTarget/patientRole/providerOrganization/name" placeholder="OOO??" target="醫療機構名稱">
								<data></data>
								<selector section="header" path="code[@displayName]" attr="displayName" target="單張名稱"></selector>
								電子病歷資料
							</selector>
						</th>
					</tr>
					<tr>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/name">
								姓名：<data></data>
								<selector section="header" path="recordTarget/patientRole/patient/administrativeGenderCode[@code]" attr="code">(<data></data>)</selector>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/id[@extension]" attr="extension">
								身分證字號：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/id[@extension]" attr="extension">
								病歷號碼：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="author/time[@value]" attr="value" match="([0-9]{4})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})" format="$1/$2/$3 $4:$5:$6">
								文件產生時間：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/maritalStatusCode[@code]" attr="code">
								婚姻狀況：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/birthTime[@value]" attr="value" match="([0-9]{4})([0-9]{2})([0-9]{2})" format="$1/$2/$3">
								B.O.D.：<data></data>
							</selector>
						</td>
						<td colspan="2">
							<selector section="header" path="recordTarget/patientRole/addr/streetAddressLine">
								地址：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='H' and @value]" attr="value">
								家用電話：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='WP' and @value]" attr="value">
								公司電話：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='MC' and @value]" attr="value">
								手機：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='PUB' and @value]" attr="value">
								E-Mail：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td colspan="4">
							<selector section="body" path="component/structuredBody/component/section/code[@code='52040-3']/../entry/observationMedia" type="observationMedia" mode="image" onEmptyHideParent="2">
								醫學影像<br/><data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td colspan="4">
							<selector section="body" path="component/structuredBody/component/section/code[@code='55107-7']/../entry/observationMedia" type="observationMedia" mode="binary" onEmptyHideParent="2">
								其他文件<br/><data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td colspan="4">
							<eachselector section="body" path="component/structuredBody/component/section/code[@code]/..">
								<selector id="title" path="title[node()] | title[not(node())]/../code[@displayName]" attr="displayName"></selector>
								<selector id="textParagraph" path="text/paragraph | text" allChildren="yes"></selector>
								<each>
									<h4><json id="title"></json></h4>
									<json id="textParagraph"></json>
								</each>
								<result><h3>病歷內容</h3></result>
							</eachselector>
						</td>
					</tr>
				</table>
			</div>
		</template>
		<script type="text/javascript">
			if (this !== window) {
				cdaDemo.prototype = {
					onClick: function(e) {
						$(e.currentTarget).find("span").each(function(index, element) {
							$(element).html("test");
						});
					}
				};
				this.lifecycle({
					created: function(root) {
						var shadow = $(root.querySelectorAll('*'));
						$(this).on("DOMNodeInserted", function(e) {cda2g.Files.selectorParse(e.relatedNode.webkitShadowRoot, $(this));});
						if(this.childNodes.length > 0) {
							cda2g.Files.selectorParse(root, $(this));
						}
					}
				});
			}
		</script>
	</decorator>
</element>