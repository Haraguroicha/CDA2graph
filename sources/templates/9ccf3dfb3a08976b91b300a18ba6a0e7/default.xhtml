<element extends="cda2g" name="cda___51897-7" constructor="cdaDemo">
	<decorator>
		<template>
			<style scoped="scoped">
				table {
					border: solid 1px black;
					border-collapse: collapse;
					width: 100%;
				}
				table th, table td {
					border: solid 1px black;
				}
				th {
					font-size: 14pt;
				}
				td {
					font-size: 10pt;
				}
			</style>
			<style scoped="scoped">
				h4 {
					margin: 0px;
					border-bottom: solid 1px #06F;
				}
				result {
					margin-top: 0px;
				}
				result ~ * {
					margin-top: 15px;
				}
				h4 ~ * {
					margin-left: 15px;
				}
			</style>
			<info>
				<header>
					<choose>
						<exist>
							<selector section="header" path="title"></selector>
						</exist>
						<otherwise>
							<selector section="header" path="code[@displayName]" attr="displayName"></selector>
						</otherwise>
					</choose>
				</header>
			</info>
			<processable>
				<green root="疾病通報" filename="121.green.xml"></green>
			</processable>
			<div class="_XCD_Component" style="display: none;">
				<table>
					<tr>
						<th colspan="4">
							<selector section="header" path="custodian/assignedCustodian/representedCustodianOrganization/name | recordTarget/patientRole/providerOrganization/name" placeholder="OOO??" target="醫院名稱">
								<h2><data></data></h2>
								<h5>
									<choose>
										<exist>
											<selector section="header" path="title"></selector>
										</exist>
										<otherwise>
											<selector section="header" path="code[@displayName]" attr="displayName"></selector>
										</otherwise>
									</choose>
								</h5>
							</selector>
						</th>
					</tr>
					<tr>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/name" target="病患>姓名">
								姓名：<data></data>
								<selector section="header" path="recordTarget/patientRole/patient/administrativeGenderCode[@code]" attr="code" target="病患>性別">(<data></data>)</selector>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/id[@extension]" attr="extension">
								身分證字號：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/id[@extension]" attr="extension">
								病歷號碼：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="author/time[@value]" attr="value" match="([0-9]{4})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})" format="$1/$2/$3 $4:$5:$6">
								文件產生時間：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/maritalStatusCode[@code]" attr="code">
								婚姻狀況：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/patient/birthTime[@value]" attr="value" match="([0-9]{4})([0-9]{2})([0-9]{2})" format="$1/$2/$3">
								B.O.D.：<data></data>
							</selector>
						</td>
						<td colspan="2">
							<selector section="header" path="recordTarget/patientRole/addr">
								地址：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='H' and @value]" attr="value">
								家用電話：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='WP' and @value]" attr="value">
								公司電話：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='MC' and @value]" attr="value">
								手機：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="recordTarget/patientRole/telecom[@use='PUB' and @value]" attr="value">
								E-Mail：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td>
							<selector section="header" path="componentOf/encompassingEncounter/effectiveTime[@value]" attr="value" match="([0-9]{4})([0-9]{2})([0-9]{2})" format="$1/$2/$3">
								發病日期：<data></data>
							</selector>
						</td>
						<td>
							<selector section="header" path="author/assignedAuthor/assignedPerson/name">
								主治醫師：<data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td colspan="4">
							<eachselector section="body" path="component/structuredBody/component/section/code[@code]/.." target="通報項目>通報資料">
								<selector id="title" path="title[node()] | title[not(node())]/../code[@displayName]" attr="displayName" target="標題"></selector>
								<selector id="textParagraph" path="text/paragraph" allChildren="yes" target="描述內容"></selector>
								<each>
									<h4><json id="title"></json></h4>
									<json id="textParagraph"></json>
								</each>
								<result><h3>通報內容</h3></result>
							</eachselector>
						</td>
					</tr>
					<tr>
						<td colspan="4">
							<selector section="body" path="component/structuredBody/component/section/code[@code='52040-3']/../entry/observationMedia" type="observationMedia" mode="image" onEmptyHideParent="2">
								醫學影像<br/><data></data>
							</selector>
						</td>
					</tr>
					<tr>
						<td colspan="4">
							<selector section="body" path="component/structuredBody/component/section/code[@code='55107-7']/../entry/observationMedia" type="observationMedia" mode="binary" onEmptyHideParent="2">
								其他文件<br/><data></data>
							</selector>
						</td>
					</tr>
				</table>
			</div>
		</template>
		<script type="text/javascript">
			if (this !== window) {
				cdaDemo.prototype = {
					onClick: function(e) {
						$(e.currentTarget).find("span").each(function(index, element) {
							$(element).html("test");
						});
					}
				};
				this.lifecycle({
					created: function(root) {
						var shadow = $(root.querySelectorAll('*'));
						$(this).on("DOMNodeInserted", function(e) {cda2g.Files.selectorParse(e.relatedNode.webkitShadowRoot, $(this));});
						if(this.childNodes.length > 0) {
							cda2g.Files.selectorParse(root, $(this));
						}
					}
				});
			}
		</script>
	</decorator>
</element>